generator client {
  provider = "prisma-client-js"
  output   = "./generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Phone {
  id        String   @id @default(cuid())
  number    String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  companyGroup   CompanyGroup? @relation(fields: [companyGroupId], references: [id])
  companyGroupId String?       @map("company_group_id")

  company   Company? @relation(fields: [companyId], references: [id])
  companyId String?  @map("company_id")

  unit   Unit?   @relation(fields: [unitId], references: [id])
  unitId String? @map("unit_id")

  @@map("phones")
}

model CompanyGroup {
  id                 String    @id @default(cuid())
  name               String
  document           String    @unique
  totalVehiclesHired Int       @default(0) @map("total_vehicles_hired")
  createdAt          DateTime  @default(now()) @map("created_at")
  updatedAt          DateTime  @updatedAt @map("updated_at")
  deletedAt          DateTime? @map("deleted_at")

  phones    Phone[]
  companies Company[]

  @@map("company_groups")
}

model Company {
  id        String    @id @default(cuid())
  name      String
  document  String    @unique
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")
  deletedAt DateTime? @map("deleted_at")

  companyGroup   CompanyGroup @relation(fields: [companyGroupId], references: [id])
  companyGroupId String       @map("company_group_id")

  phones Phone[]
  units  Unit[]

  @@map("companies")
}

model Unit {
  id        String    @id @default(cuid())
  name      String
  document  String    @unique
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")
  deletedAt DateTime? @map("deleted_at")

  company   Company @relation(fields: [companyId], references: [id])
  companyId String  @map("company_id")

  phones Phone[]

  @@map("units")
}

model User {
  id        String    @id @default(cuid())
  name      String
  document  String    @unique
  password  String
  birthDate DateTime  @map("birth_date")
  avatarUrl String?   @map("avatar_url")
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")
  deletedAt DateTime? @map("deleted_at")

  @@map("users")
}
